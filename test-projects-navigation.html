<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Projects Navigation Test</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background: #0a0e12;
      color: #e0e6ed;
    }
    h1 {
      color: #60a5fa;
      border-bottom: 2px solid #60a5fa;
      padding-bottom: 10px;
    }
    h2 {
      color: #a78bfa;
      margin-top: 30px;
    }
    .test-section {
      background: rgba(15, 23, 42, 0.6);
      border: 1px solid rgba(96, 165, 250, 0.2);
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
    }
    .pass {
      color: #10b981;
      font-weight: bold;
    }
    .fail {
      color: #ef4444;
      font-weight: bold;
    }
    .warning {
      color: #f59e0b;
      font-weight: bold;
    }
    .test-item {
      padding: 10px;
      margin: 10px 0;
      background: rgba(30, 41, 59, 0.4);
      border-left: 4px solid #60a5fa;
      border-radius: 4px;
    }
    .test-result {
      margin-top: 5px;
      padding: 5px 10px;
      border-radius: 4px;
      font-size: 14px;
    }
    button {
      background: linear-gradient(135deg, #60a5fa, #a78bfa);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      margin: 10px 5px;
    }
    button:hover {
      opacity: 0.9;
    }
    .summary {
      background: rgba(96, 165, 250, 0.1);
      border: 2px solid #60a5fa;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
      font-size: 18px;
    }
    iframe {
      width: 100%;
      height: 600px;
      border: 2px solid #60a5fa;
      border-radius: 8px;
      margin: 20px 0;
    }
  </style>
</head>
<body>
  <h1>üß™ Projects Navigation Test Suite</h1>
  <p>Testing unified navigation component on projects/index.html (subfolder page)</p>

  <div class="test-section">
    <h2>Test Controls</h2>
    <button onclick="runAllTests()">‚ñ∂Ô∏è Run All Tests</button>
    <button onclick="location.reload()">üîÑ Reload Page</button>
    <button onclick="openProjectsPage()">üîó Open Projects Page</button>
  </div>

  <div id="summary" class="summary" style="display:none;">
    <strong>Test Summary:</strong>
    <div id="summaryContent"></div>
  </div>

  <div class="test-section">
    <h2>1. File Structure Tests</h2>
    <div id="fileTests"></div>
  </div>

  <div class="test-section">
    <h2>2. Navigation Component Tests</h2>
    <div id="componentTests"></div>
  </div>

  <div class="test-section">
    <h2>3. Relative Path Tests</h2>
    <div id="pathTests"></div>
  </div>

  <div class="test-section">
    <h2>4. Visual Preview</h2>
    <p>Preview of projects/index.html with navigation:</p>
    <iframe id="preview" src="projects/index.html"></iframe>
  </div>

  <script>
    let testResults = {
      passed: 0,
      failed: 0,
      warnings: 0
    };

    function openProjectsPage() {
      window.open('projects/index.html', '_blank');
    }

    async function runAllTests() {
      testResults = { passed: 0, failed: 0, warnings: 0 };
      
      await testFileStructure();
      await testNavigationComponent();
      await testRelativePaths();
      
      showSummary();
    }

    async function testFileStructure() {
      const container = document.getElementById('fileTests');
      container.innerHTML = '<p>Running file structure tests...</p>';
      
      const tests = [];

      // Test 1: Check if navigation.css exists
      tests.push(testFile(
        'Navigation CSS exists',
        'assets/css/navigation.css',
        'Navigation styles file'
      ));

      // Test 2: Check if navigation.js exists
      tests.push(testFile(
        'Navigation JS exists',
        'assets/js/components/navigation.js',
        'Navigation component file'
      ));

      // Test 3: Check if projects/index.html exists
      tests.push(testFile(
        'Projects index exists',
        'projects/index.html',
        'Projects page file'
      ));

      const results = await Promise.all(tests);
      container.innerHTML = results.join('');
    }

    async function testFile(name, path, description) {
      try {
        const response = await fetch(path, { method: 'HEAD' });
        if (response.ok) {
          testResults.passed++;
          return createTestItem(name, 'pass', `‚úÖ ${description} found at ${path}`);
        } else {
          testResults.failed++;
          return createTestItem(name, 'fail', `‚ùå ${description} not found (${response.status})`);
        }
      } catch (error) {
        testResults.failed++;
        return createTestItem(name, 'fail', `‚ùå Error checking ${path}: ${error.message}`);
      }
    }

    async function testNavigationComponent() {
      const container = document.getElementById('componentTests');
      container.innerHTML = '<p>Running navigation component tests...</p>';
      
      const results = [];

      // Test: Load projects page and check navigation
      try {
        const response = await fetch('projects/index.html');
        const html = await response.text();

        // Test 1: Check for navigation.css link with correct path
        if (html.includes('href="../assets/css/navigation.css"')) {
          testResults.passed++;
          results.push(createTestItem(
            'Navigation CSS linked',
            'pass',
            '‚úÖ navigation.css linked with correct relative path (../)'
          ));
        } else {
          testResults.failed++;
          results.push(createTestItem(
            'Navigation CSS linked',
            'fail',
            '‚ùå navigation.css not linked or incorrect path'
          ));
        }

        // Test 2: Check for navigation.js script with correct path
        if (html.includes('src="../assets/js/components/navigation.js"')) {
          testResults.passed++;
          results.push(createTestItem(
            'Navigation JS loaded',
            'pass',
            '‚úÖ navigation.js loaded with correct relative path (../)'
          ));
        } else {
          testResults.failed++;
          results.push(createTestItem(
            'Navigation JS loaded',
            'fail',
            '‚ùå navigation.js not loaded or incorrect path'
          ));
        }

        // Test 3: Check for inline navigation styles (should be removed)
        const hasInlineNavStyles = html.includes('.header {') || 
                                   html.includes('.nav-links {') ||
                                   html.includes('.lang-switcher {');
        if (!hasInlineNavStyles) {
          testResults.passed++;
          results.push(createTestItem(
            'Inline styles removed',
            'pass',
            '‚úÖ No inline navigation styles found'
          ));
        } else {
          testResults.failed++;
          results.push(createTestItem(
            'Inline styles removed',
            'fail',
            '‚ùå Inline navigation styles still present'
          ));
        }

        // Test 4: Check for hardcoded navigation HTML (should be removed)
        const hasHardcodedNav = html.includes('<header class="header"') ||
                                html.includes('<nav class="nav"');
        if (!hasHardcodedNav) {
          testResults.passed++;
          results.push(createTestItem(
            'Hardcoded HTML removed',
            'pass',
            '‚úÖ No hardcoded navigation HTML found'
          ));
        } else {
          testResults.warning++;
          results.push(createTestItem(
            'Hardcoded HTML removed',
            'warning',
            '‚ö†Ô∏è Hardcoded navigation HTML detected (may be from component)'
          ));
        }

      } catch (error) {
        testResults.failed++;
        results.push(createTestItem(
          'Component tests',
          'fail',
          `‚ùå Error loading projects page: ${error.message}`
        ));
      }

      container.innerHTML = results.join('');
    }

    async function testRelativePaths() {
      const container = document.getElementById('pathTests');
      container.innerHTML = '<p>Running relative path tests...</p>';
      
      const results = [];

      // Test: Check if navigation.js handles relative paths correctly
      try {
        const response = await fetch('assets/js/components/navigation.js');
        const jsCode = await response.text();

        // Test 1: Check for getRelativePath function
        if (jsCode.includes('function getRelativePath()')) {
          testResults.passed++;
          results.push(createTestItem(
            'Relative path function exists',
            'pass',
            '‚úÖ getRelativePath() function found in navigation.js'
          ));
        } else {
          testResults.failed++;
          results.push(createTestItem(
            'Relative path function exists',
            'fail',
            '‚ùå getRelativePath() function not found'
          ));
        }

        // Test 2: Check for projects folder detection
        if (jsCode.includes("path.includes('/projects/')")) {
          testResults.passed++;
          results.push(createTestItem(
            'Projects folder detection',
            'pass',
            '‚úÖ Component detects /projects/ folder'
          ));
        } else {
          testResults.failed++;
          results.push(createTestItem(
            'Projects folder detection',
            'fail',
            '‚ùå Component does not detect /projects/ folder'
          ));
        }

        // Test 3: Check for ../ prefix logic
        if (jsCode.includes("return '../'")) {
          testResults.passed++;
          results.push(createTestItem(
            'Relative path prefix',
            'pass',
            '‚úÖ Component returns ../ for subfolder pages'
          ));
        } else {
          testResults.failed++;
          results.push(createTestItem(
            'Relative path prefix',
            'fail',
            '‚ùå Component does not return ../ prefix'
          ));
        }

      } catch (error) {
        testResults.failed++;
        results.push(createTestItem(
          'Path tests',
          'fail',
          `‚ùå Error loading navigation.js: ${error.message}`
        ));
      }

      container.innerHTML = results.join('');
    }

    function createTestItem(name, status, message) {
      const statusClass = status === 'pass' ? 'pass' : status === 'warning' ? 'warning' : 'fail';
      return `
        <div class="test-item">
          <strong>${name}</strong>
          <div class="test-result ${statusClass}">${message}</div>
        </div>
      `;
    }

    function showSummary() {
      const summary = document.getElementById('summary');
      const content = document.getElementById('summaryContent');
      
      const total = testResults.passed + testResults.failed + testResults.warnings;
      const passRate = total > 0 ? ((testResults.passed / total) * 100).toFixed(1) : 0;
      
      content.innerHTML = `
        <div style="margin: 10px 0;">
          <span class="pass">‚úÖ Passed: ${testResults.passed}</span> | 
          <span class="fail">‚ùå Failed: ${testResults.failed}</span> | 
          <span class="warning">‚ö†Ô∏è Warnings: ${testResults.warnings}</span>
        </div>
        <div style="margin: 10px 0;">
          <strong>Pass Rate: ${passRate}%</strong>
        </div>
        <div style="margin: 10px 0;">
          ${testResults.failed === 0 ? 
            '<span class="pass">üéâ All critical tests passed!</span>' : 
            '<span class="fail">‚ö†Ô∏è Some tests failed. Please review above.</span>'}
        </div>
      `;
      
      summary.style.display = 'block';
    }

    // Auto-run tests on page load
    window.addEventListener('load', () => {
      setTimeout(runAllTests, 500);
    });
  </script>
</body>
</html>
